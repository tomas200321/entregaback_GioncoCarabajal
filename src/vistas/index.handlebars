<h1>Productos</h1>

<form method="get" action="/products">
  <label>Filtro (category:valor o status:available): <input name="query" value="{{query}}" placeholder="category:Periféricos o status:available"></label>
  <label>Ordenar por precio: 
    <select name="sort">
      <option value="">--</option>
      <option value="asc" {{#if (eq sort 'asc')}}selected{{/if}}>Ascendente</option>
      <option value="desc" {{#if (eq sort 'desc')}}selected{{/if}}>Descendente</option>
    </select>
  </label>
  <label>Limite: <input name="limit" value="{{limit}}"></label>
  <button>Aplicar</button>
</form>

<ul id="productos">
  {{#each productos}}
    <li>
      <strong>{{this.title}}</strong> - ${{this.price}} - Categoria: {{this.category}} - Stock: {{this.stock}}
      <a href="/products/{{this._id}}">Ver detalle</a>
      <form style="display:inline" method="post" action="/api/carts/1/productos/{{this._id}}">
        <button type="submit">Agregar al carrito (carrito 1)</button>
      </form>
    </li>
  {{/each}}
</ul>

<div class="paginacion">
  {{#if hasPrevPage}}
    <a href="/products?limit={{limit}}&page={{prevPage}}{{#if sort}}&sort={{sort}}{{/if}}{{#if query}}&query={{query}}{{/if}}">Anterior</a>
  {{/if}}
  <span>Página {{page}} / {{totalPages}}</span>
  {{#if hasNextPage}}
    <a href="/products?limit={{limit}}&page={{nextPage}}{{#if sort}}&sort={{sort}}{{/if}}{{#if query}}&query={{query}}{{/if}}">Siguiente</a>
  {{/if}}
</div>
